{"version":3,"file":"patternlock.esm.js","sources":["../src/vector.ts","../src/dot.ts","../src/utils/css.ts","../src/utils/svg.ts","../src/utils/util.ts","../src/patternlock.ts"],"sourcesContent":["export class Vector {\r\n    /** X坐标 */\r\n    x: number;\r\n    /** Y坐标 */\r\n    y: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * 获取该点距离xy坐标的距离\r\n     * @param x\r\n     * @param y\r\n     */\r\n    getDistance(x: number, y: number) {\r\n        const _x = x - this.x, _y = y - this.y;\r\n        return Math.sqrt((_x * _x) + (_y * _y));\r\n    };\r\n\r\n    /**\r\n     * 判断该点是否在x1 y1 x2 y2线段上\r\n     * @param x1\r\n     * @param y1\r\n     * @param x2\r\n     * @param y2\r\n     */\r\n    isOnLine(x1: number, y1: number, x2: number, y2: number) {\r\n        if (this.y >= Math.min(y1, y2) && this.y <= Math.max(y1, y2) && this.x >= Math.min(x1, x2) && this.x <= Math.max(x1, x2)) {\r\n            const precision = (this.x - x1) * (y1 - y2) - (x1 - x2) * (this.y - y1);\r\n            if (precision < 2e-10 && precision > -2e-10) { // 实质判断是否接近0\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}","import { Vector } from \"./vector\";\r\n\r\nexport class Dot extends Vector {\r\n    /** 圆点的值 */\r\n    value: string;\r\n    /** 是否被选中 */\r\n    isActive: boolean;\r\n    /** 圆点元素 */\r\n    element: SVGCircleElement;\r\n\r\n    constructor(x: number, y: number, value: string, isActive: boolean = false) {\r\n        super(x, y);\r\n        this.value = value;\r\n        this.isActive = isActive;\r\n    }\r\n}","export class Css {\r\n    /**\r\n     * 添加CSS样式\r\n     * @param style 样式\r\n     */\r\n    static addStyle(style: string): HTMLStyleElement {\r\n        const element = document.createElement('style');\r\n        element.innerHTML = style;\r\n        document.head.appendChild(element);\r\n        return element;\r\n    }\r\n}","export class Svg {\r\n    static namespace: string = 'http://www.w3.org/2000/svg';\r\n    static version: string = '1.1';\r\n\r\n    /**\r\n     * 创建SVG系列元素\r\n     * @param name 元素名称\r\n     * @param attrObj 属性对象\r\n     */\r\n    static createElement(name: string, attrObj: { [key: string]: string | number }): Element {\r\n        const element = document.createElementNS(Svg.namespace, name);\r\n        for (const key in attrObj) {\r\n            element.setAttribute(key, attrObj[key] + '');\r\n        }\r\n        return element;\r\n    }\r\n\r\n    /**\r\n     * 创建SVG元素\r\n     */\r\n    static createSvgElement(): SVGElement {\r\n        return Svg.createElement('svg', {\r\n            xmlns: Svg.namespace,\r\n            version: Svg.version\r\n        }) as SVGElement;\r\n    }\r\n}","/**\r\n * 防抖函数\r\n * @param fn 需要进行防抖的函数\r\n * @param delay 防抖时间\r\n */\r\nexport function debounce(fn: Function, delay: number) {\r\n    let timer: number = null;\r\n    return function () {\r\n        timer && clearTimeout(timer);\r\n        timer = window.setTimeout(fn, delay);\r\n    }\r\n}","import { Dot } from './dot';\r\nimport { Css } from './utils/css';\r\nimport { Svg } from './utils/svg';\r\nimport { debounce } from './utils/util';\r\nimport { Vector } from './vector';\r\n\r\ntype PatternLockCallback = {\r\n    verify: (value: string) => boolean,\r\n    complete: (value: string) => void,\r\n    reset?: () => void\r\n};\r\n\r\nexport class PatternLock {\r\n    /** 图形锁父容器元素 */\r\n    container: HTMLElement;\r\n    /** 回调函数对象 */\r\n    callback: PatternLockCallback;\r\n    /** 图形锁的值 */\r\n    value: string;\r\n    /** 图形锁的宽度（宽度将等于高度）*/\r\n    width: number;\r\n    /** 圆点的半径 */\r\n    radius: number;\r\n    /** 圆点的外边距 */\r\n    margin: number;\r\n    /** 图形锁SVG 元素 */\r\n    svg: SVGElement;\r\n    /** 储存九个圆点实例的数组 */\r\n    dotsPos: Array<Dot> = [];\r\n    /** 折线元素 */\r\n    polyline: SVGPolylineElement;\r\n    /** 折线的上一个坐标 */\r\n    lastPos: Vector;\r\n    /** 折线的当前坐标 */\r\n    currentPos: Vector;\r\n    /** 折线的points属性值 */\r\n    points: string;\r\n    /** 图形锁是否被操作过 */\r\n    isDirty: boolean;\r\n    /** 图形锁的动画样式 */\r\n    style: HTMLStyleElement;\r\n\r\n    /**\r\n     * 构造函数\r\n     * @param selectors 选择器\r\n     * @param callback\r\n     */\r\n    constructor(selectors: string, callback: PatternLockCallback) {\r\n        this.container = document.querySelector(selectors);\r\n        this.callback = callback;\r\n\r\n        this.svg = Svg.createSvgElement();\r\n        this.svg.style.width = this.svg.style.height = '100%';\r\n        this.container.appendChild(this.svg);\r\n\r\n        this.init();\r\n\r\n        for (const dot of this.dotsPos) { // 绘制大圆点\r\n            dot.element = this.drawDot(dot.x, dot.y, this.radius, '#eee', 'dot');\r\n            this.addClickEventListener(dot);\r\n        }\r\n\r\n        this.addTouchMoveEventListener();\r\n        this.addTouchCompleteEventListener();\r\n    }\r\n\r\n    /**\r\n     * 初始化图形锁\r\n     */\r\n    init() {\r\n        // 根据父元素的尺寸计算图形锁的一些尺寸\r\n        this.width = this.container.clientWidth;\r\n        this.radius = this.width / 6 * .7;\r\n        this.margin = (this.width - this.radius * 6) / 4;\r\n\r\n        this.style && document.head.removeChild(this.style);\r\n        this.style = Css.addStyle(`\r\n            .inner-dot {\r\n                animation: gl-inner-dot-scale .25s ease-in;\r\n            }\r\n            @keyframes gl-inner-dot-scale {\r\n                0% {\r\n                    r: ${this.radius / 2.5};\r\n                } 50% {\r\n                    r: ${this.radius / 2};\r\n                } 100% {\r\n                    r: ${this.radius / 2.5};\r\n                }\r\n            }\r\n        `);\r\n\r\n        const pos = [\r\n            this.radius + this.margin,\r\n            this.radius * 3 + this.margin * 2,\r\n            this.radius * 5 + this.margin * 3\r\n        ];\r\n\r\n        this.dotsPos = [\r\n            new Dot(pos[0], pos[0], '1'),\r\n            new Dot(pos[1], pos[0], '2'),\r\n            new Dot(pos[2], pos[0], '3'),\r\n            new Dot(pos[0], pos[1], '4'),\r\n            new Dot(pos[1], pos[1], '5'),\r\n            new Dot(pos[2], pos[1], '6'),\r\n            new Dot(pos[0], pos[2], '7'),\r\n            new Dot(pos[1], pos[2], '8'),\r\n            new Dot(pos[2], pos[2], '9')\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * 为圆点元素添加ontouchstart或mousemove事件\r\n     * @param dot\r\n     */\r\n    addClickEventListener(dot: Dot) {\r\n        const listener = () => {\r\n            // 如果图形锁已经被操作过 如果该点没有被选中\r\n            if (this.isDirty || dot.isActive) { return; }\r\n\r\n            this.isDirty = true;\r\n            dot.isActive = true;\r\n            dot.element.setAttribute('fill', '#a7ffeb');\r\n            this.drawDot(dot.x, dot.y, this.radius / 2.5, '#1de9b6', 'inner-dot'); // 添加小圆点\r\n\r\n            this.lastPos = new Vector(dot.x, dot.y);    // 上一个坐标点\r\n            this.currentPos = new Vector(dot.x, dot.y); // 当前坐标点\r\n            this.points = `${dot.x} ${dot.y} `;         // 当前折线的points属性值\r\n            this.polyline = Svg.createElement('polyline', {\r\n                points: this.points,\r\n                'stroke-linejoin': 'round',\r\n                'stroke-linecap': 'round',\r\n                stroke: '#1de9b6',\r\n                style: `fill:none;stroke-width:${this.radius / 4}`\r\n            }) as SVGPolylineElement;\r\n            this.svg.appendChild(this.polyline);\r\n\r\n            this.value = `${dot.value}`;\r\n        }\r\n\r\n        if ('ontouchstart' in document.documentElement) {\r\n            dot.element.addEventListener('touchstart', (e: TouchEvent) => {\r\n                e.stopPropagation(); // 阻止冒泡\r\n                // 如果触摸点等于一\r\n                e.touches.length === 1 && listener();\r\n            });\r\n        } else {\r\n            dot.element.addEventListener('mousemove', (e: MouseEvent) => {\r\n                // 如果鼠标移动时按下左键\r\n                e.buttons === 1 && listener();\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 为图形锁SVG元素添加ontouchmove事件\r\n     */\r\n    addTouchMoveEventListener() {\r\n        const listener = (x: number, y: number, e: TouchEvent | MouseEvent) => {\r\n            e.preventDefault(); // 防止浏览器下拉\r\n            if (!this.polyline) { return; } // 如果折线不存在\r\n\r\n            x = x - this.container.offsetLeft;\r\n            y = y - this.container.offsetTop;\r\n\r\n            for (const dot of this.dotsPos) {\r\n                // 如果这个点没有被选中而且当前坐标在圆内\r\n                if (!dot.isActive && dot.getDistance(x, y) <= this.radius * .85) {\r\n                    // 让上一个坐标点等于上一次的当前坐标点\r\n                    this.lastPos.x = this.currentPos.x;\r\n                    this.lastPos.y = this.currentPos.y;\r\n\r\n                    this.currentPos = new Vector(dot.x, dot.y); //让上一次的当前坐标点等于选择的坐标点\r\n\r\n                    this.points = this.points + `${dot.x} ${dot.y} `;\r\n                    dot.element.setAttribute('fill', '#a7ffeb');\r\n                    dot.isActive = true;\r\n                    this.drawDot(dot.x, dot.y, this.radius / 2.5, '#1de9b6', 'inner-dot'); //添加小圆点\r\n\r\n                    for (const d of this.dotsPos) {\r\n                        if (!d.isActive && d.isOnLine(this.lastPos.x, this.lastPos.y, this.currentPos.x, this.currentPos.y)) {\r\n                            d.element.setAttribute('fill', '#a7ffeb');\r\n                            d.isActive = true;\r\n                            this.drawDot(d.x, d.y, this.radius / 2.5, '#1de9b6', 'inner-dot'); //添加小圆点\r\n\r\n                            this.value += d.value;\r\n                        }\r\n                    }\r\n\r\n                    this.value += dot.value;\r\n                }\r\n                this.polyline.setAttribute('points', this.points + `${x} ${y} `);\r\n            }\r\n        }\r\n\r\n        if ('ontouchmove' in document.documentElement) {\r\n            this.svg.addEventListener('touchmove', (e: TouchEvent) => {\r\n                listener(e.changedTouches[0].clientX, e.changedTouches[0].clientY, e);\r\n            })\r\n        } else {\r\n            document.addEventListener('mousemove', (e: MouseEvent) => {\r\n                // 如果鼠标移动时按下左键\r\n                (e.buttons === 1 && this.container.style.pointerEvents !== 'none') && listener(e.clientX, e.clientY, e);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 为图形锁SVG元素添加ontouchend和ontouchcancel事件\r\n     */\r\n    addTouchCompleteEventListener() {\r\n        const complete = () => {\r\n            if (!this.isDirty) { return; }\r\n            this.container.style.pointerEvents = 'none'; // 禁止触摸\r\n            this.polyline && this.polyline.setAttribute('points', this.points); // 截断被手指拉长的那段线\r\n            this.verify();\r\n            this.callback.complete && this.callback.complete(this.value);\r\n            setTimeout(() => {\r\n                this.reset();\r\n                this.container.style.pointerEvents = 'auto';\r\n            }, 1000);\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement) {\r\n            this.svg.addEventListener('touchend', () => complete());\r\n\r\n            this.svg.addEventListener('touchcancel', () => complete()); // 当触摸事件被意外中断时\r\n        } else {\r\n            document.addEventListener('mouseup', () => complete()); // 当鼠标松开时\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        window.addEventListener('resize', debounce(() => this.init(), 250));\r\n    }\r\n\r\n    /**\r\n     * 验证图形密码\r\n     */\r\n    verify() {\r\n        if (!this.callback.verify(this.value)) {\r\n            this.polyline && this.polyline.setAttribute('stroke', '#ff5252');\r\n            for (const dot of this.dotsPos) {\r\n                dot.isActive && dot.element.setAttribute('fill', '#ffcdd2');\r\n            }\r\n            const innerDots: NodeListOf<Element> = document.querySelectorAll('.inner-dot');\r\n            for (let i = 0; i < innerDots.length; i++) {\r\n                innerDots[i].setAttribute('fill', '#ff5252');\r\n            }\r\n            // 震动150毫秒\r\n            'vibrate' in window.navigator && window.navigator.vibrate(150);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 重置图形锁\r\n     */\r\n    reset() {\r\n        this.points = '';\r\n        this.value = '';\r\n        this.isDirty = false;\r\n\r\n        if (this.polyline) {\r\n            this.svg.removeChild(this.polyline);\r\n            this.polyline = null;\r\n        }\r\n\r\n        const innderDots = this.svg.querySelectorAll('.inner-dot');\r\n\r\n        for (const innerDot of innderDots) { // 清除所有小圆点\r\n            this.svg.removeChild(innerDot);\r\n        }\r\n\r\n        for (const dot of this.dotsPos) { // 绘制大圆点\r\n            if (dot.isActive) { dot.isActive = false; } // 取消选中\r\n            dot.element.getAttribute('fill') !== '#eee' && dot.element.setAttribute('fill', '#eee'); // 恢复默认颜色\r\n        }\r\n\r\n        this.callback.reset && this.callback.reset();\r\n    }\r\n\r\n    /**\r\n     * 绘制图形锁的圆点\r\n     * @param cx 圆点X坐标\r\n     * @param cy 圆点Y坐标\r\n     * @param r 圆点半径\r\n     * @param fill 填充颜色\r\n     * @param className 类名\r\n     */\r\n    drawDot(cx: number, cy: number, r: number, fill: string, className: string) {\r\n        const dotElement = Svg.createElement('circle', {\r\n            cx: cx,\r\n            cy: cy,\r\n            r: r,\r\n            fill: fill,\r\n            class: className\r\n        }) as SVGCircleElement;\r\n\r\n        this.svg.appendChild(dotElement);\r\n\r\n        return dotElement;\r\n    }\r\n}"],"names":[],"mappings":"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"}
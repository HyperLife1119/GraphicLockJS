"use strict";var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Svg=function(){function t(){}return t.createElement=function(e,n){var i=document.createElementNS(t.namespace,e);for(var o in n)i.setAttribute(o,n[o]);return i},t.createSvgElement=function(){return t.createElement("svg",{xmlns:t.namespace,version:t.version})},t.namespace="http://www.w3.org/2000/svg",t.version="1.1",t}(),Vector=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.getDistance=function(t,e){var n=t-this.x,i=e-this.y;return Math.sqrt(n*n+i*i)},t.prototype.isOnLine=function(t,e,n,i){if(this.y>=Math.min(e,i)&&this.y<=Math.max(e,i)&&this.x>=Math.min(t,n)&&this.x<=Math.max(t,n)){var o=(this.x-t)*(e-i)-(t-n)*(this.y-e);if(o<2e-10&&o>-2e-10)return!0}return!1},t}(),Dot=function(t){function e(e,n,i,o){void 0===o&&(o=!1);var s=t.call(this,e,n)||this;return s.value=i,s.isActive=o,s}return __extends(e,t),e}(Vector),Css=function(){function t(){}return t.addStyle=function(t){var e=document.createElement("style");return e.innerHTML=t,document.head.appendChild(e),e},t}(),GraphicLock=function(){function t(t,e){void 0===e&&(e={}),this.dotsPos=[],this.container=document.querySelector(t),this.callback=e,this.svg=Svg.createSvgElement(),this.svg.style.width=this.svg.style.height="100%",this.container.appendChild(this.svg),this.resize(),this.init()}return t.prototype.init=function(){this.width=this.container.clientWidth,this.radius=this.width/6*.7,this.margin=(this.width-6*this.radius)/4,this.style&&document.head.removeChild(this.style),this.style=Css.addStyle("\n            .inner-dot {\n                animation: gl-inner-dot-scale .25s ease-in;\n            }\n            @keyframes gl-inner-dot-scale {\n                0% {\n                    r: "+this.radius/2.5+";\n                } 50% {\n                    r: "+this.radius/2+";\n                } 100% {\n                    r: "+this.radius/2.5+";\n                }\n            }\n        ");var t=[this.radius+this.margin,3*this.radius+2*this.margin,5*this.radius+3*this.margin];this.dotsPos=[new Dot(t[0],t[0],"1"),new Dot(t[1],t[0],"2"),new Dot(t[2],t[0],"3"),new Dot(t[0],t[1],"4"),new Dot(t[1],t[1],"5"),new Dot(t[2],t[1],"6"),new Dot(t[0],t[2],"7"),new Dot(t[1],t[2],"8"),new Dot(t[2],t[2],"9")],this.addTouchMoveEventListener(),this.addTouchCompleteEventListener(),this.reset()},t.prototype.addClickEventListener=function(t){var e=this,n=function(){e.isDirty||t.isActive||(e.isDirty=!0,t.isActive=!0,t.element.setAttribute("fill","#a7ffeb"),e.drawDot(t.x,t.y,e.radius/2.5,"#1de9b6","inner-dot"),e.lastPos=new Vector(t.x,t.y),e.currentPos=new Vector(t.x,t.y),e.points=t.x+" "+t.y+" ",e.polyline=Svg.createElement("polyline",{points:e.points,stroke:"#1de9b6",style:"fill:none;stroke-width:"+e.radius/4}),e.svg.appendChild(e.polyline),e.value=""+t.value)};"ontouchstart"in document.documentElement?t.element.addEventListener("touchstart",(function(t){t.stopPropagation(),1==t.touches.length&&n()})):t.element.addEventListener("mousemove",(function(t){1==t.buttons&&n()}))},t.prototype.addTouchMoveEventListener=function(){var t=this,e=function(e,n,i){if(i.preventDefault(),t.polyline){e-=t.container.offsetLeft,n-=t.container.offsetTop;for(var o=0,s=t.dotsPos;o<s.length;o++){var r=s[o];if(!r.isActive&&r.getDistance(e,n)<=.85*t.radius){t.lastPos.x=t.currentPos.x,t.lastPos.y=t.currentPos.y,t.currentPos=new Vector(r.x,r.y),t.points=t.points+(r.x+" ")+r.y+" ",r.element.setAttribute("fill","#a7ffeb"),r.isActive=!0,t.drawDot(r.x,r.y,t.radius/2.5,"#1de9b6","inner-dot");for(var a=0,c=t.dotsPos;a<c.length;a++){var u=c[a];!u.isActive&&u.isOnLine(t.lastPos.x,t.lastPos.y,t.currentPos.x,t.currentPos.y)&&(u.element.setAttribute("fill","#a7ffeb"),u.isActive=!0,t.drawDot(u.x,u.y,t.radius/2.5,"#1de9b6","inner-dot"),t.value+=u.value)}t.value+=r.value}t.polyline.setAttribute("points",t.points+(e+" ")+n+" ")}}};"ontouchmove"in document.documentElement?this.svg.addEventListener("touchmove",(function(t){e(t.changedTouches[0].clientX,t.changedTouches[0].clientY,t)})):document.addEventListener("mousemove",(function(t){1==t.buttons&&e(t.clientX,t.clientY,t)}))},t.prototype.addTouchCompleteEventListener=function(){var t=this,e=function(){t.isDirty&&(t.container.style.pointerEvents="none",t.polyline&&t.polyline.setAttribute("points",t.points),t.verify(),t.callback.complete&&t.callback.complete(t.value),setTimeout((function(){t.reset(),t.container.style.pointerEvents="auto"}),1e3))};"ontouchend"in document.documentElement?(this.svg.addEventListener("touchend",(function(){e()})),this.svg.addEventListener("touchcancel",(function(){e()}))):document.addEventListener("mouseup",(function(){e()}))},t.prototype.resize=function(){var t=this;window.addEventListener("resize",this.debounce((function(){t.init()}),250))},t.prototype.verify=function(){if(!this.callback.verify||!this.callback.verify(this.value)){this.polyline&&this.polyline.setAttribute("stroke","#ff5252");for(var t=0,e=this.dotsPos;t<e.length;t++){var n=e[t];n.isActive&&n.element.setAttribute("fill","#ffcdd2")}for(var i=document.querySelectorAll(".inner-dot"),o=0;o<i.length;o++)i[o].setAttribute("fill","#ff5252");"vibrate"in window.navigator&&window.navigator.vibrate(150)}},t.prototype.reset=function(){this.svg.innerHTML="",this.points="",this.value="",this.isDirty=!1,this.polyline=null;for(var t=0,e=this.dotsPos;t<e.length;t++){var n=e[t];n.isActive&&(n.isActive=!1),n.element=this.drawDot(n.x,n.y,this.radius,"#eee","dot"),this.addClickEventListener(n)}this.callback.reset&&this.callback.reset()},t.prototype.drawDot=function(t,e,n,i,o){var s=Svg.createElement("circle",{cx:t,cy:e,r:n,fill:i,class:o});return this.svg.appendChild(s),s},t.prototype.debounce=function(t,e){var n=this,i=null;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];i&&clearTimeout(i),i=setTimeout((function(){t.apply(n,o)}),e)}},t}();
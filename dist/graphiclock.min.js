"use strict";var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Svg=function(){function t(){}return t.createElement=function(e,i){var n=document.createElementNS(t.namespace,e);for(var s in i)n.setAttribute(s,i[s]);return n},t.createSvgElement=function(){return t.createElement("svg",{xmlns:t.namespace,version:t.version})},t.namespace="http://www.w3.org/2000/svg",t.version="1.1",t}(),Vector=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.getDistance=function(t,e){var i=t-this.x,n=e-this.y;return Math.sqrt(i*i+n*n)},t.prototype.isOnLine=function(t,e,i,n){if(this.y>=Math.min(e,n)&&this.y<=Math.max(e,n)&&this.x>=Math.min(t,i)&&this.x<=Math.max(t,i)){var s=(this.x-t)*(e-n)-(t-i)*(this.y-e);if(s<2e-10&&s>-2e-10)return!0}return!1},t}(),Dot=function(t){function e(e,i,n,s){void 0===s&&(s=!1);var o=t.call(this,e,i)||this;return o.value=n,o.isActive=s,o}return __extends(e,t),e}(Vector),GraphicLock=function(){function t(t,e){void 0===e&&(e={}),this.dotsPos=[],this.container=document.querySelector(t),this.callback=e,this.value="",this.width=this.container.clientWidth,this.radius=this.width/6*.7,this.margin=(this.width-6*this.radius)/4,this.svg=Svg.createSvgElement(),this.points="",this.isDirty=!1,this.init()}return t.prototype.init=function(){this.svg.style.width=this.svg.style.height="100%",this.container.appendChild(this.svg);var t=[this.radius+this.margin,3*this.radius+2*this.margin,5*this.radius+3*this.margin];this.dotsPos=[new Dot(t[0],t[0],1),new Dot(t[1],t[0],2),new Dot(t[2],t[0],3),new Dot(t[0],t[1],4),new Dot(t[1],t[1],5),new Dot(t[2],t[1],6),new Dot(t[0],t[2],7),new Dot(t[1],t[2],8),new Dot(t[2],t[2],9)],this.reset()},t.prototype.addTouchStartEventListener=function(t){var e=this;t.element.ontouchstart=function(i){i.stopPropagation(),i.touches.length>1||e.isDirty||t.isActive||(e.isDirty=!0,t.isActive=!0,t.element.setAttribute("fill","#a7ffeb"),e.drawDot(t.x,t.y,e.radius/2.5,"#1de9b6","inner-dot"),console.log(1),e.lastPos=new Vector(t.x,t.y),e.currentPos=new Vector(t.x,t.y),e.points=t.x+" "+t.y+" ",e.polyline=Svg.createElement("polyline",{points:e.points,stroke:"#1de9b6",style:"fill:none;stroke-width:"+e.radius/4}),e.svg.appendChild(e.polyline),console.log(2),e.value=""+t.value)}},t.prototype.addTouchMoveEventListener=function(){var t=this;this.svg.ontouchmove=function(e){if(e.preventDefault(),t.polyline)for(var i=e.changedTouches[0].clientX-t.container.offsetLeft,n=e.changedTouches[0].clientY-t.container.offsetTop,s=0,o=t.dotsPos;s<o.length;s++){var r=o[s];if(!r.isActive&&r.getDistance(i,n)<=.85*t.radius){t.lastPos.x=t.currentPos.x,t.lastPos.y=t.currentPos.y,t.currentPos=new Vector(r.x,r.y),t.points=t.points+(r.x+" ")+r.y+" ",r.element.setAttribute("fill","#a7ffeb"),r.isActive=!0,t.drawDot(r.x,r.y,t.radius/2.5,"#1de9b6","inner-dot");for(var a=0,c=t.dotsPos;a<c.length;a++){var l=c[a];!l.isActive&&l.isOnLine(t.lastPos.x,t.lastPos.y,t.currentPos.x,t.currentPos.y)&&(l.element.setAttribute("fill","#a7ffeb"),l.isActive=!0,t.drawDot(l.x,l.y,t.radius/2.5,"#1de9b6","inner-dot"),t.value+=l.value)}t.value+=r.value}t.polyline.setAttribute("points",t.points+(i+" ")+n+" ")}}},t.prototype.addTouchCompleteEventListener=function(){var t=this,e=function(){t.verify(),t.container.style.pointerEvents="none",t.polyline&&t.polyline.setAttribute("points",t.points),t.isDirty&&t.callback.complete&&t.callback.complete(t.value),setTimeout((function(){t.container.style.pointerEvents="auto",t.reset()}),1750)};this.svg.ontouchend=function(){e()},this.svg.ontouchcancel=function(){e()}},t.prototype.verify=function(){if(!this.callback.verify||!this.callback.verify(this.value)){this.polyline&&this.polyline.setAttribute("stroke","#ff5252");for(var t=0,e=this.dotsPos;t<e.length;t++){var i=e[t];i.isActive&&i.element.setAttribute("fill","#ffcdd2")}for(var n=document.querySelectorAll(".inner-dot"),s=0;s<n.length;s++)n[s].setAttribute("fill","#ff5252")}},t.prototype.reset=function(){this.svg.innerHTML="",this.points="",this.value="",this.isDirty=!1,this.polyline=null;for(var t=0,e=this.dotsPos;t<e.length;t++){var i=e[t];i.isActive&&(i.isActive=!1),i.element=this.drawDot(i.x,i.y,this.radius,"#eee","dot"),this.addTouchStartEventListener(i)}this.addTouchMoveEventListener(),this.addTouchCompleteEventListener(),this.callback.reset&&this.callback.reset()},t.prototype.drawDot=function(t,e,i,n,s){var o=Svg.createElement("circle",{cx:t,cy:e,r:i,fill:n,class:s});return this.svg.appendChild(o),o},t}();